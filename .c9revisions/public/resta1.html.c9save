{"ts":1355366552955,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"<!DOCTYPE html>\n<meta charset=\"utf-8\">\n<style>\n\t \n\tsvg {\n\t  float: left;\n\t  border: solid 1px #aaa;\n\t}\n\t\n\tcircle {\n\t\tstroke : grey;\n\t\tstroke-width : 2;\n\t\tfill: brown;\n\t}\n\t\n\tcircle.selected {\n\t\tstroke : green;\n\t}\n\t\n\tcircle.empty {\n\t\tfill: none;\n\t}\n\t\n\t\n</style>\n<script src=\"http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js\"></script>\n<script src=\"http://mbostock.github.com/d3/d3.js?2.7.1\"></script>\n<body>\n<script>\n \nvar width = $('body').width(),\n\theight = $(window).height()-20,\n\tslotw = Math.floor(width/7), \n\tdslotw = Math.floor(slotw/2), \n\tsloth = Math.floor(height/7),\n\tdsloth = Math.floor(sloth/2),\n\tradius = Math.floor(0.35 * Math.min(slotw, sloth));\n\n\nvar board = [\n\t{x: 2*slotw, y:0}, {x:3*slotw, y:0}, {x:4*slotw, y:0},\n\t{x: 2*slotw, y:sloth}, {x:3*slotw, y:sloth}, {x:4*slotw, y:sloth},\n\t{x:0, y:2*sloth}, {x:1*slotw, y:2*sloth}, {x:2*slotw, y:2*sloth}, {x:3*slotw, y:2*sloth}, {x:4*slotw, y:2*sloth}, {x:5*slotw, y:2*sloth}, {x:6*slotw, y:2*sloth},\n\t{x:0, y:3*sloth}, {x:1*slotw, y:3*sloth}, {x:2*slotw, y:3*sloth}, {x:3*slotw, y:3*sloth}, {x:4*slotw, y:3*sloth}, {x:5*slotw, y:3*sloth}, {x:6*slotw, y:3*sloth},\n\t{x:0, y:4*sloth}, {x:1*slotw, y:4*sloth}, {x:2*slotw, y:4*sloth}, {x:3*slotw, y:4*sloth}, {x:4*slotw, y:4*sloth}, {x:5*slotw, y:4*sloth}, {x:6*slotw, y:4*sloth},\n\t{x: 2*slotw, y:5*sloth}, {x:3*slotw, y:5*sloth}, {x:4*slotw, y:5*sloth},\n\t{x: 2*slotw, y:6*sloth}, {x:3*slotw, y:6*sloth}, {x:4*slotw, y:6*sloth}\n]\n\nboard.forEach(function(elem, i){ elem.x += dslotw, elem.y += dsloth, elem.empty = i==16});\n\nconsole.log(board);\n \n \nvar svg = d3.select(\"body\").append(\"svg\")\n\t\t  .attr(\"width\", width)\n\t\t  .attr(\"height\", height);\n\nvar slotCircles = svg.selectAll(\"svg\")\n\t.data(board).enter()\n\t.append(\"circle\")\n\t.attr(\"class\", function(d) { return d.empty ? 'empty' : ''; })\n\t.attr(\"r\", radius)\n\t.attr(\"cx\", function(d) { return d.x; })\n\t.attr(\"cy\", function(d) { return d.y; })\n\t.on('click', function(d){ \n\t\td3.select(this).attr('class', 'selected');\n\t\t//se for pino e estiver selecionado, deseleciona\n\t\t//senao, seleciona\n\t\t\n\t\t//se nao for pino, é destino\n\t\t\n\t\t// \n\t});\n\n \nfunction dragmove(d) {\n\tconsole.log(d, this, d3.event)\n  d3.select(this)\n\t  .attr(\"cx\", d.x = Math.max(radius, Math.min(width - radius, d3.event.x)))\n\t  .attr(\"cy\", d.y = Math.max(radius, Math.min(height - radius, d3.event.y)));\n}\n \n</script>\n"]],"start1":0,"start2":0,"length1":0,"length2":2354}]],"length":2354}
{"contributors":[],"silentsave":false,"ts":1355366731079,"patch":[[{"diffs":[[0,"e : "],[-1,"green"],[1,"blue"],[0,";\n\t}"]],"start1":198,"start2":198,"length1":13,"length2":12}]],"length":2353,"saved":false}
{"contributors":[],"silentsave":false,"ts":1355367817906,"patch":[[{"diffs":[[0,"e : "],[-1,"blue"],[1,"red"],[0,";\n\t}"]],"start1":198,"start2":198,"length1":12,"length2":11}]],"length":2352,"saved":false}
{"contributors":[],"silentsave":false,"ts":1355420479781,"patch":[[{"diffs":[[0,"PE html>"],[1,"\r"],[0,"\n<meta c"]],"start1":7,"start2":7,"length1":16,"length2":17},{"diffs":[[0,"-8\">"],[1,"\r"],[0,"\n<style>"],[-1,"\n\t "],[1,"\r\n     \r"],[0,"\n\tsvg {"],[1,"\r"],[0,"\n\t  "]],"start1":35,"start2":35,"length1":26,"length2":33},{"diffs":[[0,"t: left;"],[1,"\r"],[0,"\n\t  bord"]],"start1":72,"start2":72,"length1":16,"length2":17},{"diffs":[[0,"px #aaa;"],[1,"\r"],[0,"\n\t}"],[1,"\r"],[0,"\n\t"],[1,"\r"],[0,"\n\tcircle"]],"start1":100,"start2":100,"length1":21,"length2":24},{"diffs":[[0,"circle {"],[1,"\r"],[0,"\n\t\tstrok"]],"start1":118,"start2":118,"length1":16,"length2":17},{"diffs":[[0," : grey;"],[1,"\r"],[0,"\n\t\tstrok"]],"start1":136,"start2":136,"length1":16,"length2":17},{"diffs":[[0,"h : "],[-1,"2;"],[1,"3;\r"],[0,"\n\t\tf"]],"start1":159,"start2":159,"length1":10,"length2":11},{"diffs":[[0,": brown;"],[1,"\r"],[0,"\n\t}"],[1,"\r"],[0,"\n\t"],[1,"\r"],[0,"\n\tcircle"]],"start1":173,"start2":173,"length1":21,"length2":24},{"diffs":[[0,"lected {"],[1,"\r"],[0,"\n\t\tstrok"]],"start1":200,"start2":200,"length1":16,"length2":17},{"diffs":[[0,"e : red;"],[1,"\r"],[0,"\n\t}"],[1,"\r"],[0,"\n\t"],[1,"\r"],[0,"\n\tcircle"]],"start1":217,"start2":217,"length1":21,"length2":24},{"diffs":[[0,".empty {"],[1,"\r"],[0,"\n\t\tfill:"]],"start1":241,"start2":241,"length1":16,"length2":17},{"diffs":[[0,"ll: "],[-1,"non"],[1,"white;\r\n\t}\r\n\t\r\n\tcircle.destination {\r\n\t\tfill: whit"],[0,"e;"],[1,"\r"],[0,"\n\t"],[-1,"}\n\t"],[1,"\tstroke : green;\r\n\t}\r"],[0,"\n\t"],[1,"\r"],[0,"\n</s"]],"start1":255,"start2":255,"length1":20,"length2":87},{"diffs":[[0,"</style>"],[1,"\r"],[0,"\n<script"]],"start1":339,"start2":339,"length1":16,"length2":17},{"diffs":[[0,"/script>"],[1,"\r"],[0,"\n<script"]],"start1":428,"start2":428,"length1":16,"length2":17},{"diffs":[[0,"ipt>"],[1,"\r"],[0,"\n<body>"],[1,"\r"],[0,"\n<sc"]],"start1":499,"start2":499,"length1":15,"length2":17},{"diffs":[[0,"<script>"],[1,"\r"],[0,"\n "],[1,"\r"],[0,"\nvar wid"]],"start1":513,"start2":513,"length1":18,"length2":20},{"diffs":[[0,"width(),"],[1,"\r"],[0,"\n\theight"]],"start1":548,"start2":548,"length1":16,"length2":17},{"diffs":[[0,"ht()-20,"],[1,"\r"],[0,"\n\tslotw "]],"start1":582,"start2":582,"length1":16,"length2":17},{"diffs":[[0,"dth/7), "],[1,"\r"],[0,"\n\tdslotw"]],"start1":614,"start2":614,"length1":16,"length2":17},{"diffs":[[0,"otw/2), "],[1,"\r"],[0,"\n\tsloth "]],"start1":647,"start2":647,"length1":16,"length2":17},{"diffs":[[0,"ight/7),"],[1,"\r"],[0,"\n\tdsloth"]],"start1":679,"start2":679,"length1":16,"length2":17},{"diffs":[[0,"loth/2),"],[1,"\r"],[0,"\n\tradius"]],"start1":711,"start2":711,"length1":16,"length2":17},{"diffs":[[0,"sloth));"],[-1,"\n\n"],[1,"\r\n\r\nvar validMoves = [[0,1,2],[0,3,8],[1,4,9],[2,1,0],[2,5,10],[3,4,5],[3,8,15],[4,9,16],[5,4,3],[5,10,17],[6,7,8],[6,13,20],[7,8,9],[7,14,21],[8,3,0],[8,7,6],[8,9,10],[8,15,22],[9,4,1],[9,8,7],[9,10,11],[9,16,23],[10,5,2],[10,9,8],[10,11,12],[10,17,24],[11,10,9],[11,18,25],[12,11,10],[12,19,26],[13,14,15],[14,15,16],[15,8,3],[15,14,13],[15,16,17],[15,22,27],[16,9,4],[16,15,14],[16,17,18],[16,23,28],[17,10,5],[17,16,15],[17,18,19],[17,24,29],[18,17,16],[19,18,17],[20,13,6],[20,21,22],[21,14,7],[21,22,23],[22,15,8],[22,21,20],[22,23,24],[22,27,30],[23,16,9],[23,22,21],[23,24,25],[23,28,31],[24,17,10],[24,23,22],[24,25,26],[24,29,32],[25,18,11],[25,24,23],[26,19,12],[26,25,24],[27,22,15],[27,28,29],[28,23,16],[29,24,17],[29,28,27],[30,27,22],[30,31,32],[31,28,23],[32,29,24],[32,31,30]];\r\n\r"],[0,"\nvar boa"]],"start1":765,"start2":765,"length1":18,"length2":814},{"diffs":[[0,"oard = ["],[1,"\r"],[0,"\n\t{x: 2*"]],"start1":1577,"start2":1577,"length1":16,"length2":17},{"diffs":[[0,"w, y:0},"],[1,"\r"],[0,"\n\t{x: 2*"]],"start1":1634,"start2":1634,"length1":16,"length2":17},{"diffs":[[0,"w, y:sloth},"],[1,"\r"],[0,"\n\t{x:0, y:2*"]],"start1":1699,"start2":1699,"length1":24,"length2":25},{"diffs":[[0,"otw, y:2*sloth},"],[1,"\r"],[0,"\n\t{x:0, y:3*slot"]],"start1":1859,"start2":1859,"length1":32,"length2":33},{"diffs":[[0," y:3*sloth},"],[1,"\r"],[0,"\n\t{x:0, y:4*"]],"start1":2027,"start2":2027,"length1":24,"length2":25},{"diffs":[[0,"otw, y:4*sloth},"],[1,"\r"],[0,"\n\t{x: 2*slotw, y"]],"start1":2187,"start2":2187,"length1":32,"length2":33},{"diffs":[[0,"*sloth},"],[1,"\r"],[0,"\n\t{x: 2*"]],"start1":2270,"start2":2270,"length1":16,"length2":17},{"diffs":[[0,"oth}"],[1,"\r"],[0,"\n]"],[-1,"\n"],[1,"\r\n\r"],[0,"\nboa"]],"start1":2348,"start2":2348,"length1":11,"length2":14},{"diffs":[[0,"ion("],[-1,"elem"],[1,"spot"],[0,", i){ "],[-1,"elem.x += dslotw, elem.y += dsloth, elem.empty = i==16});\n\nconsole.log(board);\n \n "],[1,"\r\n\t//Adiciona o deslocamento para centralizar o círculo\r\n\tspot.x += dslotw, spot.y += dsloth,\r\n\t\r\n\t//Determina que o slot 16 está vazio incialmente \r\n\tspot.state = i==16 ? 'empty' : '';\r\n\t\r\n\t//Movimentos válidos deste slot\r\n\tspot.validMoves = validMoves.filter(function(m) { return i==m[0] });\r\n\t\r\n\t//Função que determina se o movimento pode ser executado no estado atual\r\n\tspot.validMovesNow = function(){ return spot.validMoves.filter(function(m){ return !board[m[0]].empty() && !board[m[1]].empty() && board[m[2]].empty() }) };\r\n\t\r\n\tspot.empty = function(){return spot.state == 'empty' || spot.state == 'destination';}\r\n\t\r\n\tspot.destination = function(){return spot.state == 'destination';}\r\n\t\r\n\tspot.selected = function(){return spot.state == 'selected';}\r\n\t\r\n\tspot.cleanState = function() { \r\n\t\tswitch(spot.state) {\r\n\t\t\tcase 'selected': \tspot.state = ''; \t  break;\r\n\t\t\tcase 'destination': spot.state = 'empty'; break;\r\n\t\t} \r\n\t}\r\n\t\r\n\tspot.runMove = function() { /*spot é o destinatário*/\r\n\t\tspot.state = '';\r\n\t\tboard[spot.refMove[1]].state = 'empty';\r\n\t\tboard[spot.refMove[0]].state = 'empty';\r\n\t}\r\n});\r\n\r\n\r\nboard.cleanState = function() {\r\n\tboard.forEach(function(spot) { spot.cleanState() });\r\n}\r\n\r\nboard.selectedSpot = function() {\r\n\treturn board.filter(function(spot) { return spot.selected() })[0];\r\n}\r\n\r\nboard.selectSpot = function(spot) {\r\n\tspot.state = 'selected';\r\n\tspot.validMovesNow().forEach(function(m) {\r\n\t\tboard[m[2]].state = 'destination';\r\n\t\tboard[m[2]].refMove = m;\r\n\t});\r\n}\r\n \r"],[0,"\nvar"]],"start1":2378,"start2":2378,"length1":100,"length2":1518},{"diffs":[[0,"d(\"svg\")"],[1,"\r"],[0,"\n\t\t  .at"]],"start1":3926,"start2":3926,"length1":16,"length2":17},{"diffs":[[0,", width)"],[1,"\r"],[0,"\n\t\t  .at"]],"start1":3953,"start2":3953,"length1":16,"length2":17},{"diffs":[[0,"height);"],[-1,"\n"],[1,"\r\n\r"],[0,"\nvar slo"]],"start1":3983,"start2":3983,"length1":17,"length2":19},{"diffs":[[0,"l(\"svg\")"],[1,"\r"],[0,"\n\t.data("]],"start1":4025,"start2":4025,"length1":16,"length2":17},{"diffs":[[0,".enter()"],[1,"\r"],[0,"\n\t.appen"]],"start1":4048,"start2":4048,"length1":16,"length2":17},{"diffs":[[0,"circle\")"],[1,"\r"],[0,"\n\t.attr("]],"start1":4068,"start2":4068,"length1":16,"length2":17},{"diffs":[[0,"lass\", function("],[-1,"d"],[1,"spot"],[0,") { return d.emp"]],"start1":4087,"start2":4087,"length1":33,"length2":36},{"diffs":[[0,"urn "],[-1,"d.empty ? 'empty' : ''"],[1,"spot.state"],[0,"; })"],[1,"\r"],[0,"\n\t.a"]],"start1":4114,"start2":4114,"length1":34,"length2":23},{"diffs":[[0," radius)"],[1,"\r"],[0,"\n\t.attr("]],"start1":4145,"start2":4145,"length1":16,"length2":17},{"diffs":[[0,"(\"cx\", function("],[-1,"d"],[1,"spot"],[0,") { return d.x; "]],"start1":4161,"start2":4161,"length1":33,"length2":36},{"diffs":[[0,"urn "],[-1,"d"],[1,"spot"],[0,".x; })"],[1,"\r"],[0,"\n\t.a"]],"start1":4188,"start2":4188,"length1":15,"length2":19},{"diffs":[[0,"unction("],[-1,"d"],[1,"spot"],[0,") { retu"]],"start1":4218,"start2":4218,"length1":17,"length2":20},{"diffs":[[0,"urn "],[-1,"d"],[1,"spot"],[0,".y; })"],[1,"\r"],[0,"\n\t.o"]],"start1":4237,"start2":4237,"length1":15,"length2":19},{"diffs":[[0,"ion("],[-1,"d"],[1,"spot"],[0,"){ "],[1,"\r"],[0,"\n\t\t"],[-1,"d3.select(this).attr('class', 'selected');\n\t\t//se for pin"],[1,"if (spot.destination()) {\r\n\t\t\t//execuar açã"],[0,"o "],[1,"d"],[0,"e "],[-1,"estiver selecionado, deseleciona\n\t\t//senao,"],[1,"comer\r\n\t\t\tspot.runMove();\r\n\t\t\tupdateView();\r\n\t\t}\r\n\t\telse if (spot.empty()) {\r\n\t\t\t//não faz nada\r\n\t\t}\r\n\t\telse {\r\n\t\t\t//limpa estado e"],[0," sel"]],"start1":4272,"start2":4272,"length1":119,"length2":198},{"diffs":[[0,"iona"],[1,"\r"],[0,"\n\t\t"],[-1,"\n\t\t//se nao for pino, é destino\n\t\t\n\t\t// \n\t});\n\n \nfunction dragmove(d"],[1,"\tboard.cleanState();\r\n\t\t\tboard.selectSpot(spot);\r\n\t\t\tupdateView();\r\n\t\t}\r\n\t});\r\n\r\n\r\nfunction updateView("],[0,") {"],[1,"\r"],[0,"\n\t"],[-1,"console.log(d, this, d3.event)\n  d3.select(this)\n\t  .attr(\"cx\", d.x = Math.max(radius, Math.min(width - radius, d3.event.x)))\n\t  .attr(\"cy\", d.y = Math.max(radius, Math.min(height - radius, d3.event.y))"],[1,"var slotCircles = svg.selectAll(\"circle\")\r\n\t.data(board)\r\n\t.attr(\"class\", function(d) { return d.state; }"],[0,");"],[1,"\r"],[0,"\n}"],[-1,"\n"],[0," "],[1,"\r\n  \r"],[0,"\n</s"]],"start1":4472,"start2":4472,"length1":292,"length2":237},{"diffs":[[0,"/script>"],[1,"\r"],[0,"\n"]],"start1":4707,"start2":4707,"length1":9,"length2":10}]],"length":4717,"saved":false}
